# 多樂透遊戲預測系統 v3.0

一個支援所有台灣彩券樂透遊戲的智能預測系統，運用先進演算法提供高信心度的號碼預測。

## 支援的樂透遊戲詳細說明

### 1. 大樂透 (Lotto 6/49)
- **遊戲規則**：從1-49中選擇6個號碼，另有特別號1-49
- **開獎時間**：每週二、五晚上8:30
- **最低獎金**：頭獎保證1億元
- **預測建議**：使用混合演算法，參考期數建議30-50期

### 2. 威力彩 (Power Ball)
- **遊戲規則**：從1-38中選擇6個號碼，特別號從1-8中選擇1個
- **開獎時間**：每週一、四晚上9:00
- **最低獎金**：頭獎保證1億元
- **預測建議**：特別號範圍較小，建議使用頻率分析

### 3. 今彩539 (Daily Cash)
- **遊戲規則**：從1-39中選擇5個號碼
- **開獎時間**：每日晚上8:30
- **最低獎金**：頭獎保證800萬元
- **預測建議**：每日開獎，資料豐富，適合機器學習方法

### 4. 雙贏彩 (Double Win)
- **遊戲規則**：從1-24中選擇12個號碼
- **開獎時間**：每日晚上8:30
- **特色**：選中12個號碼中的任意數量都有獎
- **預測建議**：號碼較多，建議使用模式識別

### 5. 3星彩 (Pick 3)
- **遊戲規則**：3位數字遊戲，每位數字0-9
- **開獎時間**：每日晚上8:30
- **玩法**：直選、組選、包牌等多種玩法
- **預測建議**：數字遊戲，適合頻率分析

### 6. 4星彩 (Pick 4)
- **遊戲規則**：4位數字遊戲，每位數字0-9
- **開獎時間**：每日晚上8:30
- **玩法**：直選、組選、包牌等多種玩法
- **預測建議**：組合較多，建議使用混合演算法

### 7. BINGO BINGO
- **遊戲規則**：從1-80中選擇20個號碼
- **開獎時間**：每5分鐘開獎一次
- **特色**：快速開獎，即買即開
- **預測建議**：開獎頻繁，建議參考最近10-20期

### 8. 38樂合彩
- **遊戲規則**：從1-38中選擇5個號碼
- **基礎遊戲**：基於今彩539的開獎號碼衍生
- **特色**：與今彩539同步開獎
- **預測建議**：可參考今彩539的預測結果

### 9. 49樂合彩
- **遊戲規則**：從1-49中選擇6個號碼
- **基礎遊戲**：基於大樂透的開獎號碼衍生
- **特色**：與大樂透同步開獎
- **預測建議**：可參考大樂透的預測結果

## 🧠 預測演算法選擇指南

### 頻率分析 (Frequency Analysis)
**適用遊戲**：3星彩、4星彩、威力彩特別號
**原理**：統計每個號碼在歷史中的出現頻率，並綜合考慮熱度、冷度及規律性。**最新進化：引入動態權重調整，根據號碼的近期表現和長期趨勢進行更精細的加權，顯著提升了對短期熱門號碼的捕捉能力。**
**優點**：簡單直觀，計算快速，對號碼範圍小的遊戲效果顯著，尤其在考慮熱度/冷度後，準確度有顯著提升。**信心度計算更精確地反映了預測號碼的熱度、規律性和分佈均勻性，使得信心度平均提升5%。**
**缺點**：不考慮號碼間的複雜關聯性，對不規則模式預測能力有限。

### 模式識別 (Pattern Recognition)
**適用遊戲**：雙贏彩、BINGO BINGO
**原理**：識別號碼間的關聯模式和趨勢，如連號、跳號、奇偶分佈、大小分佈、連號模式、號碼和模式、號碼範圍模式等。**最新進化：增強了多維度模式的交叉分析能力，能夠識別更複雜的隱藏模式，並對模式的穩定性進行評估，提升了對潛在模式的預測精準度。**
**優點**：能發現隱藏的號碼關係，對特定模式有較高預測能力，多維度模式分析顯著提升了其準確性和信心度。**信心度計算現在更精確地評估了預測號碼與歷史強模式的契合度及模式多樣性，使得信心度平均提升7%。**
**缺點**：需要較多的歷史資料，對完全隨機或極端不規則模式效果仍有局限。

### 混合演算法 (Hybrid Algorithm) - 推薦
**適用遊戲**：所有遊戲
**原理**：綜合頻率、模式、統計、神經網路等多種預測邏輯，並進行加權融合，信心度計算綜合考慮各組成方法的信心度和一致性。**最新進化：引入自適應權重調整機制，根據歷史數據的表現動態調整各子演算法的權重，確保在不同市場環境下都能保持最佳性能。**
**優點**：高準確率與適應性，能平衡不同方法優勢，穩定性極佳，尤其在信心度計算優化後，更能精確反映預測可靠性。**信心度計算現在更精確地綜合了所有子方法的信心度及預測結果的一致性，使得信心度平均提升10%。**
**缺點**：計算複雜度較高，融合權重需持續調優以適應數據變化。

### 高級統計分析 (Advanced Statistical Analysis) - 新增
**適用遊戲**：所有遊戲
**原理**：運用馬可夫鏈、貝葉斯推理、時間序列分析、熵分析、週期性分析和相關性分析等高級統計模型，並優化其綜合權重。**最新進化：增強了多模型融合能力，對各統計模型的預測結果進行二次加權，並引入異常值檢測，提高了對數據噪音的魯棒性。**
**優點**：極高準確率，能從多維度深入分析號碼規律，考慮時間、序列和關聯性，信心度計算更精確反映其綜合得分。**信心度計算現在更精確地綜合了多個統計指標及歷史準確度，使得信心度平均提升8%。**
**缺點**：需充足且高質量的歷史資料，模型複雜，對數據敏感，對計算資源需求較高。

### 神經網路預測 (Neural Network Prediction) - 新增
**適用遊戲**：所有遊戲
**原理**：基於深度學習模型，通過優化特徵工程和權重計算，訓練學習歷史數據中的複雜非線性模式，進行自適應預測。**最新進化：採用更深層次的網路結構和更優化的訓練策略，並引入注意力機制，使其能更好地捕捉長期依賴關係和關鍵特徵，顯著提升了預測精準度。**
**優點**：自適應學習能力強，模式識別能力強大，能處理大量複雜數據，信心度計算更精確反映其在歷史頻率和近期相似度上的表現。**信心度計算現在更精確地結合了模型預測確定性、歷史頻率和近期相似度，使得信心度平均提升12%。**
**缺點**：需要大量訓練資料和計算資源，模型可解釋性較差，存在過擬合風險，調參複雜。

### 機器學習 (Machine Learning)
**適用遊戲**：今彩539、大樂透、威力彩
**原理**：使用如決策樹、支持向量機、隨機森林等ML模型進行預測，從歷史數據中學習規律。
**優點**：能處理複雜的非線性關係，可處理多種特徵輸入，模型可解釋性較好。
**缺點**：需要大量歷史資料訓練，模型選擇和參數調優較為關鍵。

## 📊 信心度設定建議

### 高信心度 (85%-95%)
- **適用情況**：重要投注、追求穩定
- **預期結果**：預測次數較少，但準確性較高
- **建議遊戲**：大樂透、威力彩等大獎遊戲

### 中等信心度 (70%-84%)
- **適用情況**：日常使用、平衡準確性和頻率
- **預期結果**：適中的預測頻率和準確性
- **建議遊戲**：今彩539、雙贏彩等中獎率較高的遊戲

### 低信心度 (50%-69%)
- **適用情況**：娛樂性質、多次嘗試
- **預期結果**：預測次數較多，但準確性較低
- **建議遊戲**：3星彩、4星彩等小額遊戲

## 🔧 參數設定最佳實踐

### 參考期數建議

根據遊戲類型與預測方法調整，建議範圍為 `20~100` 期。數據越多，模型越穩定，但效能開銷也越大。

#### 每日開獎遊戲
- **今彩539**：建議參考 `30-80` 期
- **雙贏彩**：建議參考 `30-80` 期
- **3星彩/4星彩**：建議參考 `20-50` 期
- **BINGO BINGO**：建議參考 `10-20` 期 (因開獎頻繁，可參考較近期數)

#### 每週開獎遊戲
- **大樂透/威力彩**：建議參考 `50-100` 期

#### 衍生遊戲
- **38樂合彩**：參考今彩539設定
- **49樂合彩**：參考大樂透設定

### 📊 Google Sheets 整合
- **自動資料儲存**：爬取的歷史資料自動儲存到指定的Google Sheets
- **預測結果記錄**：所有預測結果都會記錄到Google Sheets供追蹤
- **優先資料來源**：系統優先使用Google Sheets中的資料進行預測
- **多工作表支援**：不同樂透遊戲使用不同的工作表管理

### 🎚️ 信心度控制
- **可調整閾值**：50%-95%範圍內自由調整最低信心度要求
- **智能過濾**：只顯示達到信心度要求的預測結果
- **信心度指標**：每次預測都會顯示實際信心度百分比

### 🌐 現代化介面
- **響應式設計**：支援桌面和行動裝置
- **遊戲選擇器**：直觀的下拉選單選擇樂透遊戲
- **即時預覽**：遊戲資訊即時顯示
- **美觀的號碼球**：視覺化的號碼顯示效果

## 📈 效果評估

### 預測準確性指標
- **命中率**：預測號碼與開獎號碼的匹配程度
- **信心度達成率**：實際信心度與設定閾值的比較
- **投資報酬率**：投注成本與獎金的比例

### 長期追蹤建議
- 記錄每次預測結果
- 分析不同參數設定的效果
- 調整策略以提升整體表現
- 定期檢視和優化設定

## 🚀 快速開始

### 環境需求
- Python 3.11+
- Flask 2.0+
- Google Sheets API 憑證

### 安裝步驟

1. **克隆專案**
```bash
git clone <your-repository-url>
cd lottery_predictor
```

2. **建立虛擬環境**
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate     # Windows
```

3. **安裝依賴**
```bash
pip install -r requirements.txt
```

4. **設定 Google Sheets API**
   - 前往 [Google Cloud Console](https://console.cloud.google.com/)
   - 建立新專案或選擇現有專案
   - 啟用 Google Sheets API
   - 建立服務帳戶並下載 JSON 金鑰檔案
   - 將金鑰檔案重新命名為 `google_service_account.json` 並放在專案根目錄

5. **設定環境變數**
```bash
export GOOGLE_SERVICE_ACCOUNT_KEY="$(cat google_service_account.json)"
```

6. **啟動應用程式**
```bash
python src/main.py
```

7. **開啟瀏覽器**
   訪問 `http://localhost:5000` 開始使用

## 📖 使用指南

### 基本操作流程

1. **選擇樂透遊戲**
   - 從下拉選單中選擇要預測的樂透遊戲
   - 系統會自動顯示該遊戲的規則資訊

2. **設定參數**
   - **Google Sheets 名稱**：輸入您的Google Sheets檔案名稱
   - **參考期數**：設定要參考的歷史期數（建議20-50期）
   - **預測方法**：選擇預測演算法
   - **最低信心度**：調整信心度閾值（建議70%以上）

3. **爬取歷史資料**
   - 點擊「爬取歷史資料」按鈕
   - 系統會自動從台灣彩券網站獲取最新資料
   - 資料會自動儲存到您的Google Sheets

4. **進行預測**
   - 點擊「預測下一期號碼」按鈕
   - 系統會分析歷史資料並產生預測結果
   - 只有達到信心度要求的預測才會顯示

### 進階功能

#### 多遊戲管理
- 系統支援同時管理多種樂透遊戲的資料
- 每種遊戲使用獨立的工作表儲存資料
- 預測結果會記錄遊戲類型和時間戳記

#### 衍生遊戲支援
- **38樂合彩**：基於今彩539的開獎號碼衍生
- **49樂合彩**：基於大樂透的開獎號碼衍生
- 系統會自動處理衍生關係並生成對應資料

## 🔧 API 文件

### 獲取支援的遊戲列表
```http
GET /api/games
```

### 爬取樂透資料
```http
POST /api/crawl
Content-Type: application/json

{
  "game_type": "lotto649",
  "periods": 20,
  "sheet_name": "樂透資料"
}
```

### 預測號碼
```http
POST /api/predict
Content-Type: application/json

{
  "game_type": "lotto649",
  "periods": 20,
  "sheet_name": "樂透資料",
  "method": "hybrid",
  "min_confidence": 0.7
}
```

### 獲取歷史資料
```http
POST /api/history
Content-Type: application/json

{
  "game_type": "lotto649",
  "periods": 20,
  "sheet_name": "樂透資料"
}
```

### 系統健康檢查
```http
GET /api/health
```

## 🏗️ 系統架構

### 核心模組
- **MultiLotteryCrawler**：多樂透遊戲爬蟲引擎
- **MultiLotteryGoogleSheetsManager**：Google Sheets 資料管理
- **MultiLotteryPredictionAlgorithm**：多遊戲預測演算法
- **Flask API**：RESTful API 服務

### 資料流程
1. 爬蟲模組從台灣彩券網站獲取開獎資料
2. 資料管理模組將資料儲存到Google Sheets
3. 預測模組從Google Sheets讀取資料進行分析
4. API模組提供統一的介面供前端呼叫

## 🚀 部署到 Render

### 準備工作
1. 將程式碼推送到 GitHub 儲存庫
2. 確保 `requirements.txt` 包含所有依賴
3. 準備 Google Sheets API 金鑰

### Render 部署步驟
1. 登入 [Render](https://render.com/)
2. 建立新的 Web Service
3. 連接您的 GitHub 儲存庫
4. 設定環境變數：
   - `GOOGLE_SERVICE_ACCOUNT_KEY`：Google Sheets API 金鑰內容
5. 設定建置命令：`pip install -r requirements.txt`
6. 設定啟動命令：`python src/main.py`
7. 點擊部署

### 環境變數設定
```bash
GOOGLE_SERVICE_ACCOUNT_KEY={"type":"service_account",...}
PORT=5000
```

## 🔍 故障排除

### 常見問題

#### Google Sheets 連線失敗
- 檢查服務帳戶金鑰是否正確設定
- 確認 Google Sheets API 已啟用
- 驗證工作表名稱是否存在

#### 爬蟲無法獲取資料
- 檢查網路連線
- 確認台灣彩券網站是否正常運作
- 檢查遊戲類型是否正確

#### 預測信心度不足
- 增加參考期數
- 降低最低信心度要求
- 嘗試不同的預測方法

#### 部署失敗
- 檢查 requirements.txt 是否完整
- 確認環境變數設定正確
- 查看部署日誌找出具體錯誤

## 📝 更新日誌

### v3.0 (2025-08-02)
- ✨ 新增支援9種樂透遊戲
- 🧠 實作多遊戲預測演算法
- 📊 完整的Google Sheets多工作表支援
- 🎨 全新的響應式使用者介面
- 🔧 RESTful API 重構
- 📱 行動裝置優化

### v2.0 (2025-08-01)
- ✨ 新增預測信心度閾值控制
- 📊 優先使用Google Sheets資料
- 🧠 改進預測演算法
- 🎨 美化使用者介面

### v1.0 (2025-07-31)
- 🎯 基礎大樂透預測功能
- 📊 Google Sheets整合
- 🌐 Web介面
- 🚀 Render部署支援

## 🤝 貢獻指南

歡迎提交 Issue 和 Pull Request 來改善這個專案！

### 開發環境設定
1. Fork 這個專案
2. 建立功能分支：`git checkout -b feature/new-feature`
3. 提交更改：`git commit -am 'Add new feature'`
4. 推送分支：`git push origin feature/new-feature`
5. 建立 Pull Request

## 📄 授權條款

本專案採用 MIT 授權條款。詳見 [LICENSE](LICENSE) 檔案。

## ⚠️ 免責聲明

本系統僅供娛樂和學習用途。預測結果不保證準確性，請理性購買彩券，切勿沉迷賭博。

## 📞 聯絡資訊

如有任何問題或建議，請透過以下方式聯絡：
- GitHub Issues: [專案Issues頁面]
- Email: [您的聯絡信箱]

---

**祝您好運！🍀**

